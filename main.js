(()=>{"use strict";function e(e,t,c,n,o=!1){return{title:e,description:t,dueDate:c,priority:n,isDone:o}}const t=(()=>{let t=[];const c=document.getElementById("add-button"),n=document.querySelector(".cancel-button"),o=document.querySelector(".submit"),i=document.getElementById("overlay"),a=document.querySelector(".low"),s=document.querySelector(".medium"),r=document.querySelector(".high"),d=document.querySelector("span.error"),l=document.querySelector("[data-title]"),u=document.querySelector("[data-about]"),m=document.getElementById("due-date"),v=document.querySelector(".add-project-button"),p=document.querySelector("#add-project"),h=document.querySelector("#cancel-project"),y=document.querySelector(".projects"),E=document.getElementById("project"),f=document.querySelector(".sidebar"),k=document.querySelector(".title-error");function g(e){const c=document.querySelector(".task-items"),n=t.find((e=>e.isOn));for(let t=0;t<e.length;t++){e[t].id="task"+t;const o=document.createElement("div");I(o,"item"),"low"==e[t].priority&&I(o,"low-prio"),"medium"==e[t].priority&&I(o,"mid-prio"),"high"==e[t].priority&&I(o,"high-prio"),P(c,o);const i=document.createElement("div");P(o,i);const a=document.createElement("input");a.setAttribute("type","checkbox"),a.setAttribute("id","checkbox");const s=document.createElement("div");I(s,"task-header"),H(s,e[t].title);const r=document.createElement("button");I(r,"delete-button"),r.innerHTML="&times;",P(i,a),P(i,s),P(i,r);const d=document.createElement("div");I(d,"thin-line"),P(o,d);const l=document.createElement("div");I(l,"task-info"),H(l,e[t].description),P(o,l);const u=document.createElement("div");I(u,"thin-line"),P(o,u);const m=document.createElement("div");I(m,"task-status"),P(o,m);const v=document.createElement("input");v.setAttribute("type","date"),v.setAttribute("name","date"),v.setAttribute("id","date"),v.value=e[t].dueDate,P(m,v),r.addEventListener("click",(()=>{o.remove(),n.tasks=n.tasks.filter((c=>c.id!==e[t].id)),L(n.projectName,n)}))}}const L=(e,t)=>localStorage.setItem(e,JSON.stringify(t));function S(){I(a,"active"),B([s,r,d],"active")}function j(){I(s,"active"),B([a,r,d],"active")}function q(){I(r,"active"),B([s,a,d],"active")}function b(){B([a,s,r,d],"active"),D([u,l,m]);const e=document.querySelector("div.form");I([e,i],"active")}function N(){const e=document.querySelector("div.form");B([e,i],"active")}function C(){if(""==E.value)return I([k,h,p],"active"),void w(k,"Please choose a project title");I(y,"hide"),B(v,"hide"),x()}function x(e){const c=document.createElement("img"),n=document.createElement("img");n.src="Images/close-circle-outline.svg",c.src="Images/format-list-checks.svg";const o=document.createElement("span");H(o,E.value||e);const i=document.createElement("div");P(i,c),P(i,o),P(i,n),I(i,"a-project"),P(f,i),n.addEventListener("click",(()=>{"default"!==o.textContent&&(localStorage.removeItem(o.textContent),t=t.filter((e=>e.projectName===o.textContent)),i.remove())})),o.addEventListener("click",(()=>{if(!t.some((e=>e.projectName===o.textContent))){const e={projectName:o.textContent,tasks:[],isOn:!1};t.push(e)}t.forEach((e=>e.isOn=!1)),t.find((e=>e.projectName===o.textContent)).isOn=!0;const e=t.find((e=>e.projectName===o.textContent));T("item"),g(e.tasks)}))}function A(){I(y,"hide"),B(v,"hide"),B(k,"active")}function O(){D(E),I(v,"hide"),B([y,p,h,k],"hide")}const I=(e,t)=>Array.isArray(e)?e.forEach((e=>e.classList.add(t))):e.classList.add(t),B=(e,t)=>Array.isArray(e)?e.forEach((e=>e.classList.remove(t))):e.classList.remove(t),w=(e,t)=>e.textContent=t,D=e=>Array.isArray(e)?e.forEach((e=>e.value="")):e.value="",P=(e,t)=>e.append(t),H=(e,t)=>e.textContent=t;function T(e){const t=document.getElementsByClassName(e);for(;t.length>0;)t[0].parentNode.removeChild(t[0])}return{loadHomePage:function(){c.addEventListener("click",b),i.addEventListener("click",N),n.addEventListener("click",N),o.addEventListener("click",(()=>{const c=t.find((e=>e.isOn));return T("item"),""==l.value||""==m.value?alert("Task Title is empty or you havent chose the due date"):a.classList.contains("active")||s.classList.contains("active")||r.classList.contains("active")?a.classList.contains("active")?(c.tasks.push(e(l.value,u.value,m.value,"low")),N(),g(c.tasks),L(c.projectName,c)):s.classList.contains("active")?(c.tasks.push(e(l.value,u.value,m.value,"medium")),N(),g(c.tasks),L(c.projectName,c)):r.classList.contains("active")?(c.tasks.push(e(l.value,u.value,m.value,"high")),N(),g(c.tasks),L(c.projectName,c)):void 0:(I(d,"active"),w(d,"Please choose a priority"))})),v.addEventListener("click",O),h.addEventListener("click",A),p.addEventListener("click",C),a.addEventListener("click",S),s.addEventListener("click",j),r.addEventListener("click",q),function(){let e=Object.keys(localStorage),c=e.length;for(;c--;)t.push(JSON.parse(localStorage.getItem(e[c]))),x(e[c]);(void 0===t||0==t.length)&&t.push({projectName:"default",tasks:[],isOn:!0})}(),g(t[0].tasks)}}})();document.addEventListener("DOMContentLoaded",t.loadHomePage)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxDQUFFMUIsWUFBYSxVQUFXSixNQUFPLEdBQUl2QixNQUFNLElBaEk5RGtGLEdBQ0F4RixFQUFhdEIsRUFBVSxHQUFHbUQsVUE1Qm5CLEdDRFhqRCxTQUFTK0MsaUJBQWlCLG1CQUFvQmxELEVBQUd1RyxlIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL01vZHVsZXMvVGFzay5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvTW9kdWxlcy9wb3AtdXAtZm9ybS5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gdGFzayh0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByaW9yaXR5LCBpc0RvbmUgPSBmYWxzZSkge1xyXG4gIHJldHVybiB7XHJcbiAgICB0aXRsZSxcclxuICAgIGRlc2NyaXB0aW9uLFxyXG4gICAgZHVlRGF0ZSxcclxuICAgIHByaW9yaXR5LFxyXG4gICAgaXNEb25lLFxyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCB7IHRhc2sgfTtcclxuIiwiaW1wb3J0IHsgdGFzayB9IGZyb20gXCIuL1Rhc2tcIjtcclxuXHJcbmNvbnN0IFVJID0gKCgpID0+IHtcclxuICBsZXQgdGFza0FycmF5ID0gW107XHJcbiAgLy8gQ2FjaGluZyBUaGUgRE9NXHJcbiAgY29uc3QgYWRkVGFza0J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLWJ1dHRvblwiKTtcclxuICBjb25zdCBjYW5jZWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhbmNlbC1idXR0b25cIik7XHJcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdWJtaXRcIik7XHJcbiAgY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3ZlcmxheVwiKTtcclxuICBjb25zdCBsb3dQcmlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5sb3dcIik7XHJcbiAgY29uc3QgbWVkaXVtUHJpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVkaXVtXCIpO1xyXG4gIGNvbnN0IGhpZ2hQcmlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oaWdoXCIpO1xyXG4gIGNvbnN0IHByaW9FcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJzcGFuLmVycm9yXCIpO1xyXG4gIGNvbnN0IHRhc2tUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS10aXRsZV1cIik7XHJcbiAgY29uc3QgdGFza0Fib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWFib3V0XVwiKTtcclxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkdWUtZGF0ZVwiKTtcclxuICBjb25zdCBhZGRQcm9qZWN0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcHJvamVjdC1idXR0b25cIik7XHJcbiAgY29uc3QgYWRkUHJvamVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLXByb2plY3RcIik7XHJcbiAgY29uc3QgY2FuY2VsUHJvamVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FuY2VsLXByb2plY3RcIik7XHJcbiAgY29uc3QgcHJvamVjdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3RzXCIpO1xyXG4gIGNvbnN0IHByb2plY3RUaXRsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9qZWN0XCIpO1xyXG4gIGNvbnN0IHNpZGVCYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNpZGViYXJcIik7XHJcbiAgY29uc3QgdGl0bGVFcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGUtZXJyb3JcIik7XHJcblxyXG4gIGZ1bmN0aW9uIGxvYWRIb21lUGFnZSgpIHtcclxuICAgIGFkZFRhc2soKTtcclxuICAgIGNsb3NlVGFza0Zvcm0oKTtcclxuICAgIGFkZFByb2plY3RGb3JtKCk7XHJcbiAgICBwcmlvQnV0dG9ucygpO1xyXG4gICAgZ2V0VGFza3MoKTtcclxuICAgIGRpc3BsYXlUYXNrcyh0YXNrQXJyYXlbMF0udGFza3MpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gYWRkVGFzaygpIHtcclxuICAgIGFkZFRhc2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Gb3JtKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNsb3NlVGFza0Zvcm0oKSB7XHJcbiAgICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZUZvcm0pO1xyXG4gICAgY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZUZvcm0pO1xyXG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIC8vZmluZGluZyB3aGljaCBwcm9qZWN0IHRoZSB1c2VyIGNsaWNrZWQgb25cclxuICAgICAgY29uc3QgY2xpY2tlZFByb2plY3QgPSB0YXNrQXJyYXkuZmluZCgocHJvamVjdCkgPT4gcHJvamVjdC5pc09uKTtcclxuICAgICAgLy9yZW1vdmluZyBlbGVtZW50cyBzbyB0aGV5IGRvbnQgZHVwbGljYXRlXHJcbiAgICAgIHJlbW92ZUVsZW1lbnRzQnlDbGFzcyhcIml0ZW1cIik7XHJcblxyXG4gICAgICAvLyAgICAgSW5wdXQgRXJyb3JcclxuXHJcbiAgICAgIGlmICh0YXNrVGl0bGUudmFsdWUgPT0gXCJcIiB8fCBkYXRlLnZhbHVlID09IFwiXCIpXHJcbiAgICAgICAgcmV0dXJuIGFsZXJ0KFwiVGFzayBUaXRsZSBpcyBlbXB0eSBvciB5b3UgaGF2ZW50IGNob3NlIHRoZSBkdWUgZGF0ZVwiKTtcclxuXHJcbiAgICAgIC8vICAgICBQcmlvcml0eSBFcnJvclxyXG5cclxuICAgICAgaWYgKFxyXG4gICAgICAgICFsb3dQcmlvLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSAmJlxyXG4gICAgICAgICFtZWRpdW1QcmlvLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSAmJlxyXG4gICAgICAgICFoaWdoUHJpby5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgYWRkQ2xhc3MocHJpb0Vycm9yLCBcImFjdGl2ZVwiKTtcclxuICAgICAgICByZXR1cm4gc2hvd0Vycm9yKHByaW9FcnJvciwgXCJQbGVhc2UgY2hvb3NlIGEgcHJpb3JpdHlcIik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChsb3dQcmlvLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSkge1xyXG4gICAgICAgIGNsaWNrZWRQcm9qZWN0LnRhc2tzLnB1c2goXHJcbiAgICAgICAgICB0YXNrKHRhc2tUaXRsZS52YWx1ZSwgdGFza0Fib3V0LnZhbHVlLCBkYXRlLnZhbHVlLCBcImxvd1wiKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY2xvc2VGb3JtKCk7XHJcbiAgICAgICAgZGlzcGxheVRhc2tzKGNsaWNrZWRQcm9qZWN0LnRhc2tzKTtcclxuICAgICAgICByZXR1cm4gc3RvcmVUYXNrcyhjbGlja2VkUHJvamVjdC5wcm9qZWN0TmFtZSwgY2xpY2tlZFByb2plY3QpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAobWVkaXVtUHJpby5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikpIHtcclxuICAgICAgICBjbGlja2VkUHJvamVjdC50YXNrcy5wdXNoKFxyXG4gICAgICAgICAgdGFzayh0YXNrVGl0bGUudmFsdWUsIHRhc2tBYm91dC52YWx1ZSwgZGF0ZS52YWx1ZSwgXCJtZWRpdW1cIilcclxuICAgICAgICApO1xyXG4gICAgICAgIGNsb3NlRm9ybSgpO1xyXG4gICAgICAgIGRpc3BsYXlUYXNrcyhjbGlja2VkUHJvamVjdC50YXNrcyk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlVGFza3MoY2xpY2tlZFByb2plY3QucHJvamVjdE5hbWUsIGNsaWNrZWRQcm9qZWN0KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGhpZ2hQcmlvLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSkge1xyXG4gICAgICAgIGNsaWNrZWRQcm9qZWN0LnRhc2tzLnB1c2goXHJcbiAgICAgICAgICB0YXNrKHRhc2tUaXRsZS52YWx1ZSwgdGFza0Fib3V0LnZhbHVlLCBkYXRlLnZhbHVlLCBcImhpZ2hcIilcclxuICAgICAgICApO1xyXG4gICAgICAgIGNsb3NlRm9ybSgpO1xyXG4gICAgICAgIGRpc3BsYXlUYXNrcyhjbGlja2VkUHJvamVjdC50YXNrcyk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlVGFza3MoY2xpY2tlZFByb2plY3QucHJvamVjdE5hbWUsIGNsaWNrZWRQcm9qZWN0KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBkaXNwbGF5VGFza3MoYXJyYXkpIHtcclxuICAgIGNvbnN0IHRhc2tJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1pdGVtc1wiKTtcclxuICAgIGNvbnN0IGNsaWNrZWRQcm9qZWN0ID0gdGFza0FycmF5LmZpbmQoKHByb2plY3QpID0+IHByb2plY3QuaXNPbik7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGFycmF5W2ldLmlkID0gXCJ0YXNrXCIgKyBpO1xyXG4gICAgICBjb25zdCBpdGVtRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgYWRkQ2xhc3MoaXRlbURpdiwgXCJpdGVtXCIpO1xyXG4gICAgICBpZiAoYXJyYXlbaV0ucHJpb3JpdHkgPT0gXCJsb3dcIikgYWRkQ2xhc3MoaXRlbURpdiwgXCJsb3ctcHJpb1wiKTtcclxuICAgICAgaWYgKGFycmF5W2ldLnByaW9yaXR5ID09IFwibWVkaXVtXCIpIGFkZENsYXNzKGl0ZW1EaXYsIFwibWlkLXByaW9cIik7XHJcbiAgICAgIGlmIChhcnJheVtpXS5wcmlvcml0eSA9PSBcImhpZ2hcIikgYWRkQ2xhc3MoaXRlbURpdiwgXCJoaWdoLXByaW9cIik7XHJcbiAgICAgIGFwcGVuZENoaWxkVG9QYXJlbnQodGFza0l0ZW1zLCBpdGVtRGl2KTtcclxuICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgYXBwZW5kQ2hpbGRUb1BhcmVudChpdGVtRGl2LCBkaXYpO1xyXG4gICAgICBjb25zdCBjaGVja0JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgY2hlY2tCb3guc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImNoZWNrYm94XCIpO1xyXG4gICAgICBjaGVja0JveC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImNoZWNrYm94XCIpO1xyXG4gICAgICBjb25zdCB0YXNrVGl0bGVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBhZGRDbGFzcyh0YXNrVGl0bGVEaXYsIFwidGFzay1oZWFkZXJcIik7XHJcbiAgICAgIGFkZFRleHRUb0VsZW1lbnQodGFza1RpdGxlRGl2LCBhcnJheVtpXS50aXRsZSk7XHJcbiAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICAgIGFkZENsYXNzKGRlbGV0ZUJ1dHRvbiwgXCJkZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgICBkZWxldGVCdXR0b24uaW5uZXJIVE1MID0gXCImdGltZXM7XCI7XHJcbiAgICAgIGFwcGVuZENoaWxkVG9QYXJlbnQoZGl2LCBjaGVja0JveCk7XHJcbiAgICAgIGFwcGVuZENoaWxkVG9QYXJlbnQoZGl2LCB0YXNrVGl0bGVEaXYpO1xyXG4gICAgICBhcHBlbmRDaGlsZFRvUGFyZW50KGRpdiwgZGVsZXRlQnV0dG9uKTtcclxuICAgICAgY29uc3QgdGhpbkxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBhZGRDbGFzcyh0aGluTGluZSwgXCJ0aGluLWxpbmVcIik7XHJcbiAgICAgIGFwcGVuZENoaWxkVG9QYXJlbnQoaXRlbURpdiwgdGhpbkxpbmUpO1xyXG4gICAgICBjb25zdCB0YXNrSW5mb0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgIGFkZENsYXNzKHRhc2tJbmZvRGl2LCBcInRhc2staW5mb1wiKTtcclxuICAgICAgYWRkVGV4dFRvRWxlbWVudCh0YXNrSW5mb0RpdiwgYXJyYXlbaV0uZGVzY3JpcHRpb24pO1xyXG4gICAgICBhcHBlbmRDaGlsZFRvUGFyZW50KGl0ZW1EaXYsIHRhc2tJbmZvRGl2KTtcclxuICAgICAgY29uc3QgdGhpbkxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgYWRkQ2xhc3ModGhpbkxpbmUxLCBcInRoaW4tbGluZVwiKTtcclxuICAgICAgYXBwZW5kQ2hpbGRUb1BhcmVudChpdGVtRGl2LCB0aGluTGluZTEpO1xyXG4gICAgICBjb25zdCB0YXNrU3RhdHVzRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgYWRkQ2xhc3ModGFza1N0YXR1c0RpdiwgXCJ0YXNrLXN0YXR1c1wiKTtcclxuICAgICAgYXBwZW5kQ2hpbGRUb1BhcmVudChpdGVtRGl2LCB0YXNrU3RhdHVzRGl2KTtcclxuICAgICAgY29uc3QgZGF0ZXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgIGRhdGV5LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJkYXRlXCIpO1xyXG4gICAgICBkYXRleS5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwiZGF0ZVwiKTtcclxuICAgICAgZGF0ZXkuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJkYXRlXCIpO1xyXG4gICAgICBkYXRleS52YWx1ZSA9IGFycmF5W2ldLmR1ZURhdGU7XHJcbiAgICAgIGFwcGVuZENoaWxkVG9QYXJlbnQodGFza1N0YXR1c0RpdiwgZGF0ZXkpO1xyXG4gICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBpdGVtRGl2LnJlbW92ZSgpO1xyXG4gICAgICAgIGNsaWNrZWRQcm9qZWN0LnRhc2tzID0gY2xpY2tlZFByb2plY3QudGFza3MuZmlsdGVyKCh0b2RvKSA9PlxyXG4gICAgICAgICAgdG9kby5pZCAhPT0gYXJyYXlbaV0uaWQgPyB0cnVlIDogZmFsc2VcclxuICAgICAgICApO1xyXG4gICAgICAgIHN0b3JlVGFza3MoY2xpY2tlZFByb2plY3QucHJvamVjdE5hbWUsIGNsaWNrZWRQcm9qZWN0KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdCBzdG9yZVRhc2tzID0gKGFycmF5TmFtZSwgYXJyYXlUb0JlU3RvcmVkKSA9PlxyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYXJyYXlOYW1lLCBKU09OLnN0cmluZ2lmeShhcnJheVRvQmVTdG9yZWQpKTtcclxuXHJcbiAgZnVuY3Rpb24gZ2V0VGFza3MoKSB7XHJcbiAgICBsZXQga2V5cyA9IE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSk7XHJcbiAgICBsZXQgaSA9IGtleXMubGVuZ3RoO1xyXG4gICAgd2hpbGUgKGktLSkge1xyXG4gICAgICB0YXNrQXJyYXkucHVzaChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleXNbaV0pKSk7XHJcbiAgICAgIGNyZWF0ZVByb2plY3RzKGtleXNbaV0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRhc2tBcnJheSA9PT0gdW5kZWZpbmVkIHx8IHRhc2tBcnJheS5sZW5ndGggPT0gMFxyXG4gICAgICA/IHRhc2tBcnJheS5wdXNoKHsgcHJvamVjdE5hbWU6IFwiZGVmYXVsdFwiLCB0YXNrczogW10sIGlzT246IHRydWUgfSlcclxuICAgICAgOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJpb0J1dHRvbnMoKSB7XHJcbiAgICBsb3dQcmlvLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBwcmlvQnV0dG9uc0FjdGl2ZUdyZWVuKTtcclxuICAgIG1lZGl1bVByaW8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHByaW9CdXR0b25zQWN0aXZlWWVsbG93KTtcclxuICAgIGhpZ2hQcmlvLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBwcmlvQnV0dG9uc0FjdGl2ZVJlZCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcmlvQnV0dG9uc0FjdGl2ZUdyZWVuKCkge1xyXG4gICAgYWRkQ2xhc3MobG93UHJpbywgXCJhY3RpdmVcIik7XHJcbiAgICByZW1vdmVDbGFzcyhbbWVkaXVtUHJpbywgaGlnaFByaW8sIHByaW9FcnJvcl0sIFwiYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcHJpb0J1dHRvbnNBY3RpdmVZZWxsb3coKSB7XHJcbiAgICBhZGRDbGFzcyhtZWRpdW1QcmlvLCBcImFjdGl2ZVwiKTtcclxuICAgIHJlbW92ZUNsYXNzKFtsb3dQcmlvLCBoaWdoUHJpbywgcHJpb0Vycm9yXSwgXCJhY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcmlvQnV0dG9uc0FjdGl2ZVJlZCgpIHtcclxuICAgIGFkZENsYXNzKGhpZ2hQcmlvLCBcImFjdGl2ZVwiKTtcclxuICAgIHJlbW92ZUNsYXNzKFttZWRpdW1QcmlvLCBsb3dQcmlvLCBwcmlvRXJyb3JdLCBcImFjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG9wZW5Gb3JtKCkge1xyXG4gICAgcmVtb3ZlQ2xhc3MoW2xvd1ByaW8sIG1lZGl1bVByaW8sIGhpZ2hQcmlvLCBwcmlvRXJyb3JdLCBcImFjdGl2ZVwiKTtcclxuICAgIGNsZWFyRm9ybUlucHV0cyhbdGFza0Fib3V0LCB0YXNrVGl0bGUsIGRhdGVdKTtcclxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZGl2LmZvcm1cIik7XHJcbiAgICBhZGRDbGFzcyhbZm9ybSwgb3ZlcmxheV0sIFwiYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2xvc2VGb3JtKCkge1xyXG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJkaXYuZm9ybVwiKTtcclxuICAgIHJlbW92ZUNsYXNzKFtmb3JtLCBvdmVybGF5XSwgXCJhY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhZGRQcm9qZWN0Rm9ybSgpIHtcclxuICAgIGFkZFByb2plY3RCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qcm9qZWN0Rm9ybSk7XHJcbiAgICBjYW5jZWxQcm9qZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZVByb2plY3RGb3JtKTtcclxuICAgIGFkZFByb2plY3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFkZFByb2plY3RUaXRsZSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhZGRQcm9qZWN0VGl0bGUoKSB7XHJcbiAgICBpZiAocHJvamVjdFRpdGxlSW5wdXQudmFsdWUgPT0gXCJcIikge1xyXG4gICAgICBhZGRDbGFzcyhbdGl0bGVFcnJvciwgY2FuY2VsUHJvamVjdCwgYWRkUHJvamVjdF0sIFwiYWN0aXZlXCIpO1xyXG4gICAgICBzaG93RXJyb3IodGl0bGVFcnJvciwgXCJQbGVhc2UgY2hvb3NlIGEgcHJvamVjdCB0aXRsZVwiKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgYWRkQ2xhc3MocHJvamVjdEZvcm0sIFwiaGlkZVwiKTtcclxuICAgIHJlbW92ZUNsYXNzKGFkZFByb2plY3RCdXR0b24sIFwiaGlkZVwiKTtcclxuICAgIGNyZWF0ZVByb2plY3RzKCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVQcm9qZWN0cyhwcm9qZWN0TmFtZSkge1xyXG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgY29uc3QgY2xvc2VCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgY2xvc2VCdXR0b24uc3JjID0gXCJJbWFnZXMvY2xvc2UtY2lyY2xlLW91dGxpbmUuc3ZnXCI7XHJcbiAgICBpbWFnZS5zcmMgPSBcIkltYWdlcy9mb3JtYXQtbGlzdC1jaGVja3Muc3ZnXCI7XHJcbiAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XHJcbiAgICBhZGRUZXh0VG9FbGVtZW50KHNwYW4sIHByb2plY3RUaXRsZUlucHV0LnZhbHVlIHx8IHByb2plY3ROYW1lKTtcclxuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBhcHBlbmRDaGlsZFRvUGFyZW50KGRpdiwgaW1hZ2UpO1xyXG4gICAgYXBwZW5kQ2hpbGRUb1BhcmVudChkaXYsIHNwYW4pO1xyXG4gICAgYXBwZW5kQ2hpbGRUb1BhcmVudChkaXYsIGNsb3NlQnV0dG9uKTtcclxuICAgIGFkZENsYXNzKGRpdiwgXCJhLXByb2plY3RcIik7XHJcbiAgICBhcHBlbmRDaGlsZFRvUGFyZW50KHNpZGVCYXIsIGRpdik7XHJcbiAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBpZiAoc3Bhbi50ZXh0Q29udGVudCA9PT0gXCJkZWZhdWx0XCIpIHJldHVybjtcclxuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oc3Bhbi50ZXh0Q29udGVudCk7XHJcbiAgICAgIHRhc2tBcnJheSA9IHRhc2tBcnJheS5maWx0ZXIoXHJcbiAgICAgICAgKHByb2plY3QpID0+IHByb2plY3QucHJvamVjdE5hbWUgPT09IHNwYW4udGV4dENvbnRlbnRcclxuICAgICAgKTtcclxuICAgICAgZGl2LnJlbW92ZSgpO1xyXG4gICAgfSk7XHJcbiAgICBzcGFuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICAhdGFza0FycmF5LnNvbWUoKHByb2plY3QpID0+IHByb2plY3QucHJvamVjdE5hbWUgPT09IHNwYW4udGV4dENvbnRlbnQpXHJcbiAgICAgICkge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RPYmplY3QgPSB7XHJcbiAgICAgICAgICBwcm9qZWN0TmFtZTogc3Bhbi50ZXh0Q29udGVudCxcclxuICAgICAgICAgIHRhc2tzOiBbXSxcclxuICAgICAgICAgIGlzT246IGZhbHNlLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGFza0FycmF5LnB1c2gocHJvamVjdE9iamVjdCk7XHJcbiAgICAgIH1cclxuICAgICAgdGFza0FycmF5LmZvckVhY2goKHByb2plY3QpID0+IChwcm9qZWN0LmlzT24gPSBmYWxzZSkpO1xyXG4gICAgICB0YXNrQXJyYXkuZmluZChcclxuICAgICAgICAocHJvamVjdCkgPT4gcHJvamVjdC5wcm9qZWN0TmFtZSA9PT0gc3Bhbi50ZXh0Q29udGVudFxyXG4gICAgICApLmlzT24gPSB0cnVlO1xyXG4gICAgICBjb25zdCBjcmVhdGVkUHJvamVjdCA9IHRhc2tBcnJheS5maW5kKFxyXG4gICAgICAgIChwcm9qZWN0KSA9PiBwcm9qZWN0LnByb2plY3ROYW1lID09PSBzcGFuLnRleHRDb250ZW50XHJcbiAgICAgICk7XHJcbiAgICAgIHJlbW92ZUVsZW1lbnRzQnlDbGFzcyhcIml0ZW1cIik7XHJcbiAgICAgIGRpc3BsYXlUYXNrcyhjcmVhdGVkUHJvamVjdC50YXNrcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNsb3NlUHJvamVjdEZvcm0oKSB7XHJcbiAgICBhZGRDbGFzcyhwcm9qZWN0Rm9ybSwgXCJoaWRlXCIpO1xyXG4gICAgcmVtb3ZlQ2xhc3MoYWRkUHJvamVjdEJ1dHRvbiwgXCJoaWRlXCIpO1xyXG4gICAgcmVtb3ZlQ2xhc3ModGl0bGVFcnJvciwgXCJhY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBvcGVuUHJvamVjdEZvcm0oKSB7XHJcbiAgICBjbGVhckZvcm1JbnB1dHMocHJvamVjdFRpdGxlSW5wdXQpO1xyXG4gICAgYWRkQ2xhc3MoYWRkUHJvamVjdEJ1dHRvbiwgXCJoaWRlXCIpO1xyXG4gICAgcmVtb3ZlQ2xhc3MoW3Byb2plY3RGb3JtLCBhZGRQcm9qZWN0LCBjYW5jZWxQcm9qZWN0LCB0aXRsZUVycm9yXSwgXCJoaWRlXCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gVXRpbGl0eSBmdW5jdGlvbnNcclxuXHJcbiAgY29uc3QgYWRkQ2xhc3MgPSAoZWxlbWVudHMsIGNsYXNzTmFtZSkgPT5cclxuICAgIEFycmF5LmlzQXJyYXkoZWxlbWVudHMpXHJcbiAgICAgID8gZWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4gZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSkpXHJcbiAgICAgIDogZWxlbWVudHMuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xyXG5cclxuICBjb25zdCByZW1vdmVDbGFzcyA9IChlbGVtZW50cywgY2xhc3NOYW1lKSA9PlxyXG4gICAgQXJyYXkuaXNBcnJheShlbGVtZW50cylcclxuICAgICAgPyBlbGVtZW50cy5mb3JFYWNoKChlbGVtZW50KSA9PiBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKSlcclxuICAgICAgOiBlbGVtZW50cy5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XHJcblxyXG4gIGNvbnN0IHNob3dFcnJvciA9IChlbGVtZW50LCBtZXNzYWdlKSA9PiAoZWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2UpO1xyXG5cclxuICBjb25zdCBjbGVhckZvcm1JbnB1dHMgPSAoZWxlbWVudHMpID0+XHJcbiAgICBBcnJheS5pc0FycmF5KGVsZW1lbnRzKVxyXG4gICAgICA/IGVsZW1lbnRzLmZvckVhY2goKGVsZW1lbnQpID0+IChlbGVtZW50LnZhbHVlID0gXCJcIikpXHJcbiAgICAgIDogKGVsZW1lbnRzLnZhbHVlID0gXCJcIik7XHJcblxyXG4gIGNvbnN0IGFwcGVuZENoaWxkVG9QYXJlbnQgPSAocGFyZW50LCBjaGlsZCkgPT4gcGFyZW50LmFwcGVuZChjaGlsZCk7XHJcblxyXG4gIGNvbnN0IGFkZFRleHRUb0VsZW1lbnQgPSAoZWxlbWVudCwgdGV4dCkgPT4gKGVsZW1lbnQudGV4dENvbnRlbnQgPSB0ZXh0KTtcclxuXHJcbiAgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudHNCeUNsYXNzKGNsYXNzTmFtZSkge1xyXG4gICAgY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGNsYXNzTmFtZSk7XHJcbiAgICB3aGlsZSAoZWxlbWVudHMubGVuZ3RoID4gMCkgZWxlbWVudHNbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50c1swXSk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbG9hZEhvbWVQYWdlLFxyXG4gIH07XHJcbn0pKCk7XHJcblxyXG5leHBvcnQgeyBVSSB9O1xyXG4iLCJpbXBvcnQgeyBVSSB9IGZyb20gXCIuL01vZHVsZXMvcG9wLXVwLWZvcm1cIjtcclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgVUkubG9hZEhvbWVQYWdlKTtcclxuIl0sIm5hbWVzIjpbInRhc2siLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiZHVlRGF0ZSIsInByaW9yaXR5IiwiaXNEb25lIiwiVUkiLCJ0YXNrQXJyYXkiLCJhZGRUYXNrQnV0dG9uIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNhbmNlbEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJzdWJtaXRCdXR0b24iLCJvdmVybGF5IiwibG93UHJpbyIsIm1lZGl1bVByaW8iLCJoaWdoUHJpbyIsInByaW9FcnJvciIsInRhc2tUaXRsZSIsInRhc2tBYm91dCIsImRhdGUiLCJhZGRQcm9qZWN0QnV0dG9uIiwiYWRkUHJvamVjdCIsImNhbmNlbFByb2plY3QiLCJwcm9qZWN0Rm9ybSIsInByb2plY3RUaXRsZUlucHV0Iiwic2lkZUJhciIsInRpdGxlRXJyb3IiLCJkaXNwbGF5VGFza3MiLCJhcnJheSIsInRhc2tJdGVtcyIsImNsaWNrZWRQcm9qZWN0IiwiZmluZCIsInByb2plY3QiLCJpc09uIiwiaSIsImxlbmd0aCIsImlkIiwiaXRlbURpdiIsImNyZWF0ZUVsZW1lbnQiLCJhZGRDbGFzcyIsImFwcGVuZENoaWxkVG9QYXJlbnQiLCJkaXYiLCJjaGVja0JveCIsInNldEF0dHJpYnV0ZSIsInRhc2tUaXRsZURpdiIsImFkZFRleHRUb0VsZW1lbnQiLCJkZWxldGVCdXR0b24iLCJpbm5lckhUTUwiLCJ0aGluTGluZSIsInRhc2tJbmZvRGl2IiwidGhpbkxpbmUxIiwidGFza1N0YXR1c0RpdiIsImRhdGV5IiwidmFsdWUiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwidGFza3MiLCJmaWx0ZXIiLCJ0b2RvIiwic3RvcmVUYXNrcyIsInByb2plY3ROYW1lIiwiYXJyYXlOYW1lIiwiYXJyYXlUb0JlU3RvcmVkIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcmlvQnV0dG9uc0FjdGl2ZUdyZWVuIiwicmVtb3ZlQ2xhc3MiLCJwcmlvQnV0dG9uc0FjdGl2ZVllbGxvdyIsInByaW9CdXR0b25zQWN0aXZlUmVkIiwib3BlbkZvcm0iLCJjbGVhckZvcm1JbnB1dHMiLCJmb3JtIiwiY2xvc2VGb3JtIiwiYWRkUHJvamVjdFRpdGxlIiwic2hvd0Vycm9yIiwiY3JlYXRlUHJvamVjdHMiLCJpbWFnZSIsImNsb3NlQnV0dG9uIiwic3JjIiwic3BhbiIsInRleHRDb250ZW50IiwicmVtb3ZlSXRlbSIsInNvbWUiLCJwcm9qZWN0T2JqZWN0IiwicHVzaCIsImZvckVhY2giLCJjcmVhdGVkUHJvamVjdCIsInJlbW92ZUVsZW1lbnRzQnlDbGFzcyIsImNsb3NlUHJvamVjdEZvcm0iLCJvcGVuUHJvamVjdEZvcm0iLCJlbGVtZW50cyIsImNsYXNzTmFtZSIsIkFycmF5IiwiaXNBcnJheSIsImVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJtZXNzYWdlIiwicGFyZW50IiwiY2hpbGQiLCJhcHBlbmQiLCJ0ZXh0IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImxvYWRIb21lUGFnZSIsImFsZXJ0IiwiY29udGFpbnMiLCJrZXlzIiwiT2JqZWN0IiwicGFyc2UiLCJnZXRJdGVtIiwidW5kZWZpbmVkIiwiZ2V0VGFza3MiXSwic291cmNlUm9vdCI6IiJ9